##########################################################################
# ğŸ§ª ScraperAPI å–®é»æ”»å …æ¸¬è©¦ v1.4
##########################################################################
# ç›®çš„ï¼šæ¡ç”¨ RS (Rescue-Standalone) ç¨ç«‹è·¯å¾‘è…³æœ¬ã€‚
# ç‰¹è‰²ï¼šä¸ä¾è³´ src/ é‚è¼¯ï¼Œå¾¹åº•æ’é™¤ 400/499 è¡çªï¼Œé©—è­‰ API èˆ‡ä»£ç†é€šé“ã€‚
##########################################################################

name: ğŸ§ª ScraperAPI Single Point Test

on:
  workflow_dispatch: # æ”¯æ´åœ¨ GitHub ä»‹é¢æ‰‹å‹•å•Ÿå‹•ä»»å‹™

jobs:
  single_target_test:
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ“¦ æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4

    - name: ğŸ è¨­å®š Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'
        cache: 'pip' # é–‹å•Ÿ pip å¿«å–æ©Ÿåˆ¶åŠ é€Ÿå¾ŒçºŒåŸ·è¡Œ

    - name: âš™ï¸ å®‰è£å¿…è¦ä¾è³´
      run: |
        sudo apt-get update && sudo apt-get install -y ffmpeg # ç³»çµ±å±¤ï¼šå®‰è£éŸ³è¨Šå£“ç¸®å¿…è¦çµ„ä»¶
        python -m pip install --upgrade pip # ç’°å¢ƒå±¤ï¼šç¢ºä¿å¥—ä»¶ç®¡ç†å·¥å…·ç‚ºæœ€æ–°ç‰ˆ
        pip install "curl_cffi>=0.7.0" "requests[socks]" feedparser google-generativeai groq PySocks sgmllib3k python-dotenv google-cloud-storage supabase # æ‡‰ç”¨å±¤ï¼šå®‰è£å°ˆæ¡ˆæ‰€éœ€å‡½å¼åº«

#--- [æ­¥é©Ÿï¼šåŸ·è¡Œä¸‹è¼‰æ¼”ç¿’] å‰é¢ YML çµæ§‹ç›¸åŒ ---#
    - name: ğŸš€ åŸ·è¡Œ RS ç¨ç«‹è·¯å¾‘æ”»å …æ¼”ç¿’
      env:
        SCRAP_API_KEY: ${{ secrets.SCRAP_API_KEY }}
        PYTHONUNBUFFERED: 1
      run: |
        echo "ğŸ›¡ï¸ [æŠ¹é™¤èˆŠé‚è¼¯] å•Ÿå‹•ç´”æ·¨ RS æ²™ç›’æ¸¬è©¦..."
        python src/rs_pilot_test.py # ğŸš€ æ”¹ç‚ºåŸ·è¡Œç¨ç«‹æª”æ¡ˆ
 