##########################################################################
# ğŸ§ª S-Plan è§£ç¢¼å®˜é¦–èˆªæ¸¬è©¦ v2.0
##########################################################################
# ç›®çš„ï¼šæ¸¬è©¦ podcast_scra_officer.py æ˜¯å¦èƒ½é ˜å–æ¨™é¡Œä¸¦æˆåŠŸè§£ç¢¼ MP3 é€£çµã€‚
# ç‰¹è‰²ï¼šå®Œæ•´ä¸²æ¥ Supabase èˆ‡ ScraperAPIï¼Œå¯¦ç¾æƒ…å ±å›å¡«é–‰ç’°ã€‚
##########################################################################

name: ğŸ§ª S-Plan Officer Decoding Test

on:
  workflow_dispatch: # æ”¯æ´åœ¨ GitHub ä»‹é¢æ‰‹å‹•å•Ÿå‹•ä»»å‹™

jobs:
  officer_decoding_test:
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ“¦ æª¢å‡ºç¨‹å¼ç¢¼
      uses: actions/checkout@v4

    - name: ğŸ è¨­å®š Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: '3.12'
        cache: 'pip'

    - name: âš™ï¸ å®‰è£å¿…è¦ä¾è³´
      run: |
        python -m pip install --upgrade pip
        # ğŸš€ é—œéµï¼šç¢ºä¿å®‰è£äº† supabase èˆ‡ BeautifulSoup
        pip install requests beautifulsoup4 supabase python-dotenv

    - name: ğŸš€ åŸ·è¡Œè§£ç¢¼å®˜é ˜å‘½æ¼”ç¿’
      env:
        # ğŸ”— å¿…é ˆæä¾›ä»¥ä¸‹ä¸‰å€‹ Secrets æ‰èƒ½å®Œæˆæƒ…å ±å°æ¥
        SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
        SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
        SCRAP_API_KEY: ${{ secrets.SCRAP_API_KEY }}
        PYTHONUNBUFFERED: 1
      run: |
        echo "ğŸ“¡ [å•Ÿå‹•æŒ‡ä»¤] æ­£åœ¨å‘¼å«è§£ç¢¼å®˜åŸ·è¡Œä»»å‹™..."
        # ğŸ¯ æ”¹ç‚ºåŸ·è¡Œè§£ç¢¼å®˜ä¸»ç¨‹å¼
        python src/podcast_scra_officer.py